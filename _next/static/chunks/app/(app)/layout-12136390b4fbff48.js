(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[814],{9016:function(e,t,s){Promise.resolve().then(s.bind(s,2240))},2240:function(e,t,s){"use strict";s.d(t,{default:function(){return m}});var l=s(7437),r=s(683),a=s(4368),i=s(6294),n=s(5118),o=s(6463),d=s(2265);function u(e){var t,s,u,c;let{isOpen:x,onClose:m,currentGroupId:h}=e,{user:p}=(0,r.aC)(),b=(0,o.useRouter)(),[f,v]=(0,d.useState)("select-group"),[g,w]=(0,d.useState)("");(0,d.useEffect)(()=>{x?(v(h?"form":"select-group"),w(null!=h?h:"")):(v("select-group"),w(""))},[x,h]),(0,d.useEffect)(()=>{if(!x)return;let e=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=e}},[x]),(0,d.useEffect)(()=>{if(x)return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e);function e(e){"Escape"===e.key&&m()}},[x,m]);let j=(0,n.a)({queryKey:["groups",null==p?void 0:p.id],enabled:x&&!!(null==p?void 0:p.id),queryFn:async()=>(null==p?void 0:p.id)?(0,i.a_)(p.id):[]}),N=(0,d.useMemo)(()=>{var e,t;return null!==(t=null===(e=j.data)||void 0===e?void 0:e.find(e=>e.id===g))&&void 0!==t?t:null},[j.data,g]),y=(0,n.a)({queryKey:["group-detail",g],enabled:x&&!!g,queryFn:async()=>{if(!g)throw Error("No se encontr\xf3 el grupo");return(0,i.JM)(g)},staleTime:1e4}),C=(0,d.useCallback)(()=>{m(),v("select-group"),w("")},[m]),k=(0,d.useCallback)(()=>{if(!g){C();return}h?C():(C(),b.push("/grupos/detalle?id=".concat(g)))},[h,C,b,g]);return x?(0,l.jsxs)("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-slate-950/70 px-4 py-10 backdrop-blur",children:[(0,l.jsx)("div",{className:"absolute inset-0",onClick:C}),(0,l.jsx)("div",{className:"relative z-10 w-full max-w-3xl",children:(0,l.jsxs)("div",{className:"".concat("rounded-3xl border border-white/10 bg-gradient-to-br from-white/10 via-white/5 to-transparent p-6 backdrop-blur-xl shadow-2xl shadow-purple-900/30"," space-y-6"),children:[(0,l.jsxs)("header",{className:"flex items-start justify-between gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-slate-300",children:"Appagar"}),(0,l.jsx)("h2",{className:"mt-2 text-2xl font-semibold text-white",children:"select-group"===f?"\xbfEn qu\xe9 grupo quieres a\xf1adir el gasto?":"Registrar nuevo gasto"}),"form"===f&&N&&(0,l.jsxs)("p",{className:"mt-1 text-xs text-slate-200/80",children:[N.name," \xb7 Base ",N.baseCurrency]})]}),(0,l.jsx)("button",{type:"button",onClick:C,className:"flex h-10 w-10 items-center justify-center rounded-full border border-white/10 bg-white/10 text-lg text-white transition hover:border-white/30 hover:bg-white/20","aria-label":"Cerrar",children:"\xd7"})]}),"select-group"===f&&!h&&(0,l.jsxs)("section",{className:"space-y-4",children:[j.isLoading&&(0,l.jsx)("p",{className:"text-sm text-slate-200/80",children:"Cargando tus grupos..."}),j.error&&(0,l.jsx)("p",{className:"text-sm text-red-300",children:null!==(s=j.error.message)&&void 0!==s?s:"No se pudieron recuperar tus grupos"}),!j.isLoading&&(null!==(u=null===(t=j.data)||void 0===t?void 0:t.length)&&void 0!==u?u:0)===0&&(0,l.jsxs)("div",{className:"space-y-3 rounded-2xl border border-dashed border-white/20 p-6 text-sm text-slate-200/80",children:[(0,l.jsx)("p",{children:"No tienes grupos disponibles todav\xeda."}),(0,l.jsx)("p",{children:"Crea uno nuevo desde la pesta\xf1a Grupos para registrar gastos."})]}),j.data&&j.data.length>0&&(0,l.jsx)("ul",{className:"space-y-3",children:j.data.map(e=>(0,l.jsx)("li",{children:(0,l.jsxs)("button",{type:"button",className:"flex w-full flex-col gap-1 rounded-2xl border border-white/10 bg-black/20 px-5 py-4 text-left text-sm text-slate-100 transition hover:border-white/30 hover:bg-white/10",onClick:()=>{w(e.id),v("form")},children:[(0,l.jsx)("span",{className:"text-base font-semibold text-white",children:e.name}),(0,l.jsxs)("span",{className:"text-xs text-slate-200/70",children:[e.memberCount," miembros \xb7 Base ",e.baseCurrency]})]})},e.id))})]}),"form"===f&&(0,l.jsxs)("section",{className:"space-y-5",children:[!h&&(0,l.jsx)("button",{type:"button",className:"text-xs font-semibold text-indigo-200 underline-offset-2 hover:text-white hover:underline",onClick:()=>{v("select-group"),w("")},children:"â† Cambiar de grupo"}),y.isLoading&&(0,l.jsx)("p",{className:"text-sm text-slate-200/80",children:"Preparando el formulario..."}),y.error&&(0,l.jsx)("p",{className:"text-sm text-red-300",children:null!==(c=y.error.message)&&void 0!==c?c:"No se pudo cargar la informaci\xf3n del grupo"}),y.data&&0===y.data.members.length&&(0,l.jsx)("p",{className:"text-sm text-slate-200/80",children:"Invita al menos a un miembro antes de registrar nuevos gastos en este grupo."}),y.data&&y.data.members.length>0&&(0,l.jsx)(a.a,{baseCurrency:y.data.group.base_currency,groupId:y.data.group.id,members:y.data.members,onSuccess:k})]})]})})]}):null}var c=s(7138);let x=[{href:"/",label:"Inicio"},{href:"/amigos",label:"Amigos"},{href:"/grupos",label:"Grupos"},{href:"/actividad",label:"Actividad"},{href:"/cuenta",label:"Cuenta"}];function m(e){var t,s,a,i;let{children:n}=e,m=(0,o.usePathname)(),h=(0,o.useSearchParams)(),{profile:p,user:b}=(0,r.aC)(),[f,v]=(0,d.useState)(!1),[g,w]=(0,d.useState)(void 0),j=(0,d.useMemo)(()=>{var e;if(!m||"/"===m)return"/";let t=x.find(e=>"/"!==e.href&&m.startsWith(e.href));return null!==(e=null==t?void 0:t.href)&&void 0!==e?e:"/"},[m]),N=(0,d.useMemo)(()=>{var e;if(m&&m.startsWith("/grupos/detalle"))return null!==(e=null==h?void 0:h.get("id"))&&void 0!==e?e:void 0},[m,h]),y=(0,d.useCallback)(()=>{(null==m?void 0:m.startsWith("/grupos/detalle"))&&N?w(N):w(void 0),v(!0)},[m,N]),C=(0,d.useCallback)(()=>{v(!1),w(void 0)},[]);return(0,l.jsx)(r.ZP,{children:(0,l.jsxs)("div",{className:"relative min-h-screen overflow-hidden bg-slate-950 text-slate-100",children:[(0,l.jsxs)("div",{className:"pointer-events-none absolute inset-0 overflow-hidden",children:[(0,l.jsx)("div",{className:"absolute -top-40 left-1/2 h-[28rem] w-[28rem] -translate-x-1/2 rounded-full bg-purple-500/30 blur-3xl"}),(0,l.jsx)("div",{className:"absolute bottom-0 left-0 h-80 w-80 rounded-full bg-blue-600/20 blur-3xl"}),(0,l.jsx)("div",{className:"absolute -bottom-24 right-12 h-72 w-72 rounded-full bg-emerald-500/20 blur-3xl"}),(0,l.jsx)("div",{className:"absolute top-24 right-0 h-64 w-64 rounded-full bg-cyan-400/10 blur-2xl"})]}),(0,l.jsxs)("div",{className:"relative mx-auto flex min-h-screen w-full max-w-6xl flex-col px-4 pb-28 pt-8 sm:px-6 lg:px-8",children:[(0,l.jsxs)("header",{className:"mb-8 flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.35em] text-slate-300",children:"Appagar"}),(0,l.jsx)("h1",{className:"mt-2 text-3xl font-semibold text-white sm:text-4xl",children:null!==(s=null!==(t=null==p?void 0:p.display_name)&&void 0!==t?t:null==b?void 0:b.email)&&void 0!==s?s:"Compa\xf1ero/a"}),(0,l.jsx)("p",{className:"mt-1 text-sm text-slate-300",children:"Organiza tus gastos compartidos sin perder estilo."})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3 rounded-full border border-white/10 bg-white/10 px-4 py-2 backdrop-blur-xl",children:[(0,l.jsx)("span",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-white/10 text-lg font-semibold text-white",children:(null!==(i=null!==(a=null==p?void 0:p.display_name)&&void 0!==a?a:null==b?void 0:b.email)&&void 0!==i?i:"A").slice(0,1).toUpperCase()}),(0,l.jsxs)("div",{className:"text-xs text-slate-300",children:[(0,l.jsx)("p",{className:"font-medium text-white/90",children:"Sesi\xf3n activa"}),(0,l.jsx)("p",{children:null==b?void 0:b.email})]})]})]}),(0,l.jsx)("main",{className:"flex-1",children:(0,l.jsx)("div",{className:"space-y-6 pb-14",children:n})})]}),(0,l.jsx)("nav",{className:"fixed bottom-6 left-1/2 z-20 w-[clamp(18rem,90vw,28rem)] -translate-x-1/2 rounded-full border border-white/10 bg-white/10 px-3 py-2 backdrop-blur-xl",children:(0,l.jsx)("ul",{className:"flex items-center justify-between text-xs font-medium",children:x.map(e=>{let t=j===e.href;return(0,l.jsx)("li",{className:"flex-1",children:(0,l.jsx)(c.default,{className:"flex flex-col items-center gap-1 rounded-full px-3 py-2 transition ".concat(t?"bg-white/20 text-white shadow-lg shadow-white/10":"text-slate-300 hover:text-white"),href:e.href,children:(0,l.jsx)("span",{children:e.label})})},e.href)})})}),(0,l.jsx)("button",{"aria-label":"Registrar nuevo gasto",className:"fixed bottom-28 right-6 z-30 flex h-16 w-16 items-center justify-center rounded-full bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 text-3xl font-semibold text-white shadow-2xl shadow-purple-500/30 transition hover:scale-105 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-white md:right-10",onClick:y,type:"button",children:"+"}),(0,l.jsx)(u,{currentGroupId:g,isOpen:f,onClose:C})]})})}}},function(e){e.O(0,[543,973,586,194,368,971,23,744],function(){return e(e.s=9016)}),_N_E=e.O()}]);