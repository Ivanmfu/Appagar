(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{6814:function(e,a,s){Promise.resolve().then(s.bind(s,1193))},1193:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return l}});var r=s(7437),t=s(4316),n=s(6463),i=s(2265);function l(){let e=(0,n.useRouter)(),[a,s]=(0,i.useState)("login"),[l,o]=(0,i.useState)(""),[c,d]=(0,i.useState)(""),[u,m]=(0,i.useState)(!1),[x,h]=(0,i.useState)(""),[p,g]=(0,i.useState)(!1),[b,f]=(0,i.useState)(!1);async function N(){if(!l||!c){h("Por favor ingresa tu email y contrase\xf1a");return}if(c.length<6){h("La contrase\xf1a debe tener al menos 6 caracteres");return}try{h(""),g(!0);let s=(0,t.N)();if("signup"===a){let{error:e}=await s.auth.signUp({email:l,password:c,options:{emailRedirectTo:window.location.origin+"/Appagar"}});if(e)throw e;m(!0)}else{let{error:a}=await s.auth.signInWithPassword({email:l,password:c});if(a)throw a;e.push("/")}}catch(e){console.error(e),h(e instanceof Error?e.message:"Error al procesar la solicitud")}finally{g(!1)}}async function y(){if(!l){h("Por favor ingresa tu email");return}try{h(""),g(!0);let e=(0,t.N)(),{error:a}=await e.auth.signInWithOtp({email:l,options:{emailRedirectTo:window.location.origin+"/Appagar"}});if(a)throw a;m(!0)}catch(e){console.error(e),h(e instanceof Error?e.message:"Error al enviar enlace")}finally{g(!1)}}async function v(){try{h(""),g(!0);let e=(0,t.N)(),{error:a}=await e.auth.signInWithOAuth({provider:"google",options:{redirectTo:"".concat(window.location.origin,"/Appagar")}});if(a)throw a}catch(e){console.error(e),h(e instanceof Error?e.message:"Error al iniciar sesi\xf3n con Google"),g(!1)}}return((0,i.useEffect)(()=>{let e=new URLSearchParams(window.location.search),a=new URLSearchParams(window.location.hash.slice(1));(e.has("code")||a.has("access_token"))&&(console.log("[Login] OAuth callback detectado, procesando..."),f(!0))},[]),b)?(0,r.jsxs)("main",{className:"p-6 max-w-md mx-auto mt-12 space-y-4 text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,r.jsx)("h1",{className:"text-2xl font-semibold",children:"Completando inicio de sesi\xf3n..."}),(0,r.jsx)("p",{className:"text-gray-600",children:"Estamos procesando tu autenticaci\xf3n con Google."})]}):u?(0,r.jsxs)("main",{className:"p-6 max-w-md mx-auto mt-12 space-y-4 text-center",children:[(0,r.jsx)("div",{className:"text-5xl",children:"\uD83D\uDCE7"}),(0,r.jsx)("h1",{className:"text-2xl font-semibold",children:"\xa1Revisa tu correo!"}),(0,r.jsxs)("p",{className:"text-gray-600",children:["Hemos enviado ","signup"===a?"un enlace de confirmaci\xf3n":"un enlace m\xe1gico"," a ",(0,r.jsx)("strong",{children:l})]}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:["signup"===a?"Haz clic en el enlace del email para confirmar tu cuenta.":"Haz clic en el enlace del email para acceder a tu cuenta.",(0,r.jsx)("br",{}),"El enlace es v\xe1lido por 1 hora."]}),(0,r.jsx)("button",{className:"text-blue-600 hover:underline text-sm",onClick:()=>{m(!1),o(""),d("")},children:"Volver"})]}):(0,r.jsxs)("main",{className:"p-6 max-w-md mx-auto mt-12 space-y-6",children:[(0,r.jsxs)("div",{className:"text-center space-y-2",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold",children:"Bienvenido a Appagar"}),(0,r.jsx)("p",{className:"text-gray-600",children:"signup"===a?"Crea tu cuenta para comenzar":"Inicia sesi\xf3n en tu cuenta"})]}),(0,r.jsxs)("div",{className:"space-y-4 bg-white p-6 rounded-lg border shadow-sm",children:[(0,r.jsxs)("div",{className:"flex border-b",children:[(0,r.jsx)("button",{className:"flex-1 pb-2 text-sm font-medium ".concat("login"===a?"border-b-2 border-blue-600 text-blue-600":"text-gray-500 hover:text-gray-700"),onClick:()=>{s("login"),h("")},children:"Iniciar sesi\xf3n"}),(0,r.jsx)("button",{className:"flex-1 pb-2 text-sm font-medium ".concat("signup"===a?"border-b-2 border-blue-600 text-blue-600":"text-gray-500 hover:text-gray-700"),onClick:()=>{s("signup"),h("")},children:"Registrarse"})]}),(0,r.jsxs)("button",{className:"w-full flex items-center justify-center gap-3 border border-gray-300 hover:bg-gray-50 px-4 py-3 rounded-md font-medium transition-colors",onClick:v,disabled:p,children:[(0,r.jsxs)("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),(0,r.jsx)("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),(0,r.jsx)("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),(0,r.jsx)("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continuar con Google"]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,r.jsx)("div",{className:"w-full border-t border-gray-300"})}),(0,r.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,r.jsx)("span",{className:"px-2 bg-white text-gray-500",children:"o"})})]}),"magic-link"!==a?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,r.jsx)("input",{id:"email",className:"border border-gray-300 p-3 w-full rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"tu@email.com",value:l,onChange:e=>{o(e.target.value),h("")},type:"email",required:!0,disabled:p})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Contrase\xf1a"}),(0,r.jsx)("input",{id:"password",className:"border border-gray-300 p-3 w-full rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"••••••••",value:c,onChange:e=>{d(e.target.value),h("")},onKeyDown:e=>"Enter"===e.key&&N(),type:"password",required:!0,disabled:p}),"signup"===a&&(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"M\xednimo 6 caracteres"})]}),x&&(0,r.jsx)("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-md",children:x}),(0,r.jsx)("button",{className:"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white px-4 py-3 rounded-md w-full font-medium transition-colors",onClick:N,disabled:p,children:p?"Procesando...":"signup"===a?"Crear cuenta":"Iniciar sesi\xf3n"}),(0,r.jsx)("button",{className:"text-blue-600 hover:underline text-sm w-full",onClick:()=>s("magic-link"),disabled:p,children:"\xbfPrefieres un enlace m\xe1gico sin contrase\xf1a?"})]}):(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,r.jsx)("input",{id:"email",className:"border border-gray-300 p-3 w-full rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"tu@email.com",value:l,onChange:e=>{o(e.target.value),h("")},onKeyDown:e=>"Enter"===e.key&&y(),type:"email",required:!0,disabled:p})]}),x&&(0,r.jsx)("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-md",children:x}),(0,r.jsx)("button",{className:"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white px-4 py-3 rounded-md w-full font-medium transition-colors",onClick:y,disabled:p,children:p?"Enviando...":"Enviar enlace m\xe1gico"}),(0,r.jsx)("button",{className:"text-blue-600 hover:underline text-sm w-full",onClick:()=>s("login"),disabled:p,children:"Volver a login con contrase\xf1a"}),(0,r.jsx)("div",{className:"text-xs text-gray-500 text-center",children:"Te enviaremos un enlace m\xe1gico para acceder sin contrase\xf1a."})]})]})]})}},4316:function(e,a,s){"use strict";s.d(a,{N:function(){return n}});var r=s(46);let t=globalThis;function n(){let e="https://hlhcpdymkqhqpsaafthm.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhsaGNwZHlta3FocXBzYWFmdGhtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI1NDA0MTgsImV4cCI6MjA3ODExNjQxOH0.H_6vnlgCcT_gxmKK9MSOpI9w-p49VnsTV5WZtNcAmys";if(!e||!a)throw Error("Missing NEXT_PUBLIC_SUPABASE_URL or NEXT_PUBLIC_SUPABASE_ANON_KEY environment variables");return t.__supabaseClient||(t.__supabaseClient=(0,r.eI)(e,a,{auth:{persistSession:!0,autoRefreshToken:!0,flowType:"pkce",detectSessionInUrl:!0,storage:window.localStorage,storageKey:"appagar-auth"},global:{headers:{"x-client-info":"appagar-web"}},db:{schema:"public"},realtime:{params:{eventsPerSecond:2}}})),t.__supabaseClient}}},function(e){e.O(0,[543,971,23,744],function(){return e(e.s=6814)}),_N_E=e.O()}]);