(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2132:function(e,l,n){Promise.resolve().then(n.bind(n,8212))},8212:function(e,l,n){"use strict";n.r(l),n.d(l,{default:function(){return s}});var r=n(7437),a=n(683),t=n(7138);function s(){var e,l;let{profile:n,user:s,loading:u}=(0,a.aC)();return u?(0,r.jsx)("main",{className:"p-6 text-sm text-gray-500",children:"Comprobando sesi\xf3n..."}):(0,r.jsx)(a.ZP,{children:(0,r.jsxs)("main",{className:"p-6 space-y-4",children:[(0,r.jsxs)("h1",{className:"text-2xl font-semibold",children:["Hola, ",null!==(l=null!==(e=null==n?void 0:n.display_name)&&void 0!==e?e:null==s?void 0:s.email)&&void 0!==l?l:"compa\xf1ero/a"]}),(0,r.jsx)("p",{className:"text-gray-600",children:"Gestiona tus grupos, a\xf1ade gastos y mant\xe9n el balance al d\xeda."}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)(t.default,{className:"bg-black text-white px-4 py-2 rounded",href:"/groups",children:"Ver grupos"}),(0,r.jsx)(t.default,{className:"border border-black px-4 py-2 rounded",href:"/groups?new=1",children:"Crear grupo"})]})]})})}},683:function(e,l,n){"use strict";n.d(l,{Ho:function(){return o},aC:function(){return d}});var r=n(7437),a=n(4316),t=n(6463),s=n(2265);let u=(0,s.createContext)(void 0);async function i(e){var l;if(!e)return null;let n=(0,a.N)(),{data:r,error:t}=await n.from("profiles").select("id, email, display_name").eq("id",e.id).maybeSingle();if(t)return console.error("Error al comprobar el perfil",t),null!=r?r:null;if(r)return r;let s={id:e.id,email:e.email,display_name:null===(l=e.user_metadata)||void 0===l?void 0:l.display_name},{data:u,error:i}=await (0,a.N)().from("profiles").upsert(s).select("id, email, display_name").single();return i?(console.error("Error al crear el perfil",i),null!=r?r:s):null!=u?u:s}function o(e){let{children:l}=e,n=(0,t.useRouter)(),o=(0,t.usePathname)(),[d,c]=(0,s.useState)(null),[f,p]=(0,s.useState)(null),[m,v]=(0,s.useState)(!0),_=(0,a.N)(),h=(0,s.useCallback)(async()=>{var e,l;v(!0);let{data:n,error:r}=await _.auth.getSession();if(r){console.error("Error al recuperar la sesi\xf3n",r),c(null),p(null),v(!1);return}let a=null!==(e=n.session)&&void 0!==e?e:null;c(a);let t=await i(null!==(l=null==a?void 0:a.user)&&void 0!==l?l:null);p(null!=t?t:null),v(!1)},[_]);(0,s.useEffect)(()=>{let e=!0;h().finally(()=>{e&&v(!1)});let{data:l}=_.auth.onAuthStateChange(async(e,l)=>{var r;c(l);let a=await i(null!==(r=null==l?void 0:l.user)&&void 0!==r?r:null);p(null!=a?a:null),l||"/login"===o?l&&"/login"===o&&n.replace("/"):n.replace("/login")});return()=>{e=!1,l.subscription.unsubscribe()}},[o,h,n,_]);let x=(0,s.useMemo)(()=>{var e;return{session:d,user:null!==(e=null==d?void 0:d.user)&&void 0!==e?e:null,profile:f,loading:m,refresh:h}},[d,f,m,h]);return(0,r.jsx)(u.Provider,{value:x,children:l})}function d(){let e=(0,s.useContext)(u);if(!e)throw Error("useAuth debe usarse dentro de un AuthProvider");return e}l.ZP=function(e){let{children:l}=e,{loading:n,user:a}=d();return n?(0,r.jsx)("div",{className:"p-6 text-sm text-gray-500",children:"Cargando sesi\xf3n..."}):a?(0,r.jsx)(r.Fragment,{children:l}):null}},4316:function(e,l,n){"use strict";n.d(l,{N:function(){return s}});var r=n(46),a=n(357);let t=globalThis;function s(){let e=a.env.NEXT_PUBLIC_SUPABASE_URL,l=a.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;if(!e||!l)throw Error("Missing NEXT_PUBLIC_SUPABASE_URL or NEXT_PUBLIC_SUPABASE_ANON_KEY environment variables");return t.__supabaseClient||(t.__supabaseClient=(0,r.eI)(e,l)),t.__supabaseClient}}},function(e){e.O(0,[46,291,971,23,744],function(){return e(e.s=2132)}),_N_E=e.O()}]);