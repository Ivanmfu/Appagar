(()=>{var e={};e.id=626,e.ids=[626],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4320:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>i.a,__next_app__:()=>c,originalPathname:()=>p,pages:()=>d,routeModule:()=>m,tree:()=>u}),t(974),t(5495),t(5866);var n=t(3191),a=t(8716),s=t(7922),i=t.n(s),l=t(5231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);t.d(r,o);let u=["",{children:["login",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,974)),"/home/runner/work/Appagar/Appagar/src/app/login/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,5495)),"/home/runner/work/Appagar/Appagar/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],d=["/home/runner/work/Appagar/Appagar/src/app/login/page.tsx"],p="/login/page",c={require:t,loadChunk:()=>Promise.resolve()},m=new n.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/login/page",pathname:"/login",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:u}})},2472:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,2994,23)),Promise.resolve().then(t.t.bind(t,6114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,9671,23)),Promise.resolve().then(t.t.bind(t,1868,23)),Promise.resolve().then(t.t.bind(t,4759,23))},9775:(e,r,t)=>{Promise.resolve().then(t.bind(t,2126))},1119:(e,r,t)=>{Promise.resolve().then(t.bind(t,4146))},4146:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>i});var n=t(326),a=t(2777),s=t(7577);function i(){let[e,r]=(0,s.useState)("");async function t(){try{let r=(0,a.N)();await r.auth.signInWithOtp({email:e}),alert("Revisa tu correo para iniciar sesi\xf3n")}catch(e){console.error(e),alert("No se pudo iniciar sesi\xf3n: faltan variables de entorno de Supabase")}}return(0,n.jsxs)("main",{className:"p-6 max-w-sm mx-auto space-y-4",children:[n.jsx("h1",{className:"text-xl font-semibold",children:"Entrar"}),n.jsx("input",{className:"border p-2 w-full",placeholder:"tu@email",value:e,onChange:e=>r(e.target.value),type:"email",required:!0}),n.jsx("button",{className:"bg-black text-white px-4 py-2 rounded",onClick:t,children:"Enviar enlace"})]})}},2126:(e,r,t)=>{"use strict";t.d(r,{default:()=>o});var n=t(326),a=t(4179),s=t(2852),i=t(4976),l=t(7577);function o({children:e}){let[r]=(0,l.useState)(()=>new s.S);return n.jsx(i.aH,{client:r,children:n.jsx(a.Ho,{children:e})})}},4179:(e,r,t)=>{"use strict";t.d(r,{Ho:()=>u,ZP:()=>p,aC:()=>d});var n=t(326),a=t(2777),s=t(5047),i=t(7577);let l=(0,i.createContext)(void 0);async function o(e){if(!e)return null;let r=(0,a.N)(),{data:t,error:n}=await r.from("profiles").select("id, email, display_name").eq("id",e.id).maybeSingle();if(n)return console.error("Error al comprobar el perfil",n),t??null;if(t)return t;let s={id:e.id,email:e.email,display_name:e.user_metadata?.display_name},{data:i,error:l}=await (0,a.N)().from("profiles").upsert(s).select("id, email, display_name").single();return l?(console.error("Error al crear el perfil",l),t??s):i??s}function u({children:e}){(0,s.useRouter)(),(0,s.usePathname)();let[r,t]=(0,i.useState)(null),[u,d]=(0,i.useState)(null),[p,c]=(0,i.useState)(!0),m=(0,a.N)(),h=(0,i.useCallback)(async()=>{c(!0);let{data:e,error:r}=await m.auth.getSession();if(r){console.error("Error al recuperar la sesi\xf3n",r),t(null),d(null),c(!1);return}let n=e.session??null;t(n),d(await o(n?.user??null)??null),c(!1)},[m]),g=(0,i.useMemo)(()=>({session:r,user:r?.user??null,profile:u,loading:p,refresh:h}),[r,u,p,h]);return n.jsx(l.Provider,{value:g,children:e})}function d(){let e=(0,i.useContext)(l);if(!e)throw Error("useAuth debe usarse dentro de un AuthProvider");return e}let p=function({children:e}){let{loading:r,user:t}=d();return r?n.jsx("div",{className:"p-6 text-sm text-gray-500",children:"Cargando sesi\xf3n..."}):t?n.jsx(n.Fragment,{children:e}):null}},2777:(e,r,t)=>{"use strict";t.d(r,{N:()=>s});var n=t(3815);let a=globalThis;function s(){let e=process.env.NEXT_PUBLIC_SUPABASE_URL,r=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;if(!e||!r)throw Error("Missing NEXT_PUBLIC_SUPABASE_URL or NEXT_PUBLIC_SUPABASE_ANON_KEY environment variables");return a.__supabaseClient||(a.__supabaseClient=(0,n.eI)(e,r)),a.__supabaseClient}},5495:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>s});var n=t(9510);let a=(0,t(8570).createProxy)(String.raw`/home/runner/work/Appagar/Appagar/src/app/providers.tsx#default`);function s({children:e}){return n.jsx("html",{lang:"es",children:n.jsx("body",{children:n.jsx(a,{children:e})})})}t(5023)},974:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>n});let n=(0,t(8570).createProxy)(String.raw`/home/runner/work/Appagar/Appagar/src/app/login/page.tsx#default`)},5023:()=>{}};var r=require("../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[861],()=>t(4320));module.exports=n})();