(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7213:function(e,l,n){Promise.resolve().then(n.bind(n,8212))},8212:function(e,l,n){"use strict";n.r(l),n.d(l,{default:function(){return s}});var r=n(7437),a=n(683),t=n(7138);function s(){var e,l;let{profile:n,user:s,loading:i}=(0,a.aC)();return i?(0,r.jsx)("main",{className:"p-6 text-sm text-gray-500",children:"Comprobando sesi\xf3n..."}):(0,r.jsx)(a.ZP,{children:(0,r.jsxs)("main",{className:"p-6 space-y-4",children:[(0,r.jsxs)("h1",{className:"text-2xl font-semibold",children:["Hola, ",null!==(l=null!==(e=null==n?void 0:n.display_name)&&void 0!==e?e:null==s?void 0:s.email)&&void 0!==l?l:"compa\xf1ero/a"]}),(0,r.jsx)("p",{className:"text-gray-600",children:"Gestiona tus grupos, a\xf1ade gastos y mant\xe9n el balance al d\xeda."}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)(t.default,{className:"bg-black text-white px-4 py-2 rounded",href:"/groups",children:"Ver grupos"}),(0,r.jsx)(t.default,{className:"border border-black px-4 py-2 rounded",href:"/groups?new=1",children:"Crear grupo"})]})]})})}},683:function(e,l,n){"use strict";n.d(l,{Ho:function(){return o},aC:function(){return c}});var r=n(7437),a=n(4316),t=n(6463),s=n(2265);let i=(0,s.createContext)(void 0);async function u(e){var l;if(!e)return null;let n=(0,a.N)(),{data:r,error:t}=await n.from("profiles").select("id, email, display_name").eq("id",e.id).maybeSingle();if(t)return console.error("Error al comprobar el perfil",t),null!=r?r:null;if(r)return r;let s={id:e.id,email:e.email,display_name:null===(l=e.user_metadata)||void 0===l?void 0:l.display_name},{data:i,error:u}=await (0,a.N)().from("profiles").upsert(s).select("id, email, display_name").single();return u?(console.error("Error al crear el perfil",u),null!=r?r:s):null!=i?i:s}function o(e){let{children:l}=e,n=(0,t.useRouter)(),o=(0,t.usePathname)(),[c,d]=(0,s.useState)(null),[p,m]=(0,s.useState)(null),[f,h]=(0,s.useState)(!0),v=(0,a.N)(),x=(0,s.useCallback)(async()=>{var e,l;h(!0);let{data:n,error:r}=await v.auth.getSession();if(r){console.error("Error al recuperar la sesi\xf3n",r),d(null),m(null),h(!1);return}let a=null!==(e=n.session)&&void 0!==e?e:null;d(a);let t=await u(null!==(l=null==a?void 0:a.user)&&void 0!==l?l:null);m(null!=t?t:null),h(!1)},[v]);(0,s.useEffect)(()=>{let e=!0;x().finally(()=>{e&&h(!1)});let{data:l}=v.auth.onAuthStateChange(async(e,l)=>{var r;d(l);let a=await u(null!==(r=null==l?void 0:l.user)&&void 0!==r?r:null);m(null!=a?a:null),l||"/login"===o?l&&"/login"===o&&n.replace("/"):n.replace("/login")});return()=>{e=!1,l.subscription.unsubscribe()}},[o,x,n,v]);let _=(0,s.useMemo)(()=>{var e;return{session:c,user:null!==(e=null==c?void 0:c.user)&&void 0!==e?e:null,profile:p,loading:f,refresh:x}},[c,p,f,x]);return(0,r.jsx)(i.Provider,{value:_,children:l})}function c(){let e=(0,s.useContext)(i);if(!e)throw Error("useAuth debe usarse dentro de un AuthProvider");return e}l.ZP=function(e){let{children:l}=e,{loading:n,user:a}=c();return n?(0,r.jsx)("div",{className:"p-6 text-sm text-gray-500",children:"Cargando sesi\xf3n..."}):a?(0,r.jsx)(r.Fragment,{children:l}):null}},4316:function(e,l,n){"use strict";n.d(l,{N:function(){return t}});var r=n(46);let a=globalThis;function t(){let e="https://hlhcpdymkqhqpsaafthm.supabase.co",l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhsaGNwZHlta3FocXBzYWFmdGhtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI1NDA0MTgsImV4cCI6MjA3ODExNjQxOH0.H_6vnlgCcT_gxmKK9MSOpI9w-p49VnsTV5WZtNcAmys";if(!e||!l)throw Error("Missing NEXT_PUBLIC_SUPABASE_URL or NEXT_PUBLIC_SUPABASE_ANON_KEY environment variables");return a.__supabaseClient||(a.__supabaseClient=(0,r.eI)(e,l)),a.__supabaseClient}}},function(e){e.O(0,[46,291,971,23,744],function(){return e(e.s=7213)}),_N_E=e.O()}]);